import { types } from 'mobx-state-tree';
import { Card, CardModelSnapshotType } from './Card';
import { Card as CardType } from '../types/cardTypes';

export const CardEditorStore = types
  .model('CardEditor', {
    currentCard: Card,
    autoGenerateDescription: types.boolean,
  })
  .actions(self => ({
    updateCurrentCard(card: Partial<CardType>) {
      self.currentCard = {
        ...self.currentCard,
        ...(card as CardModelSnapshotType),
        effects: card.effects
          ? /* tslint:disable no-any */
            (card.effects.toArray() as any)
          : self.currentCard.effects,
      };
    },
    toggleAutoGenerateDescription() {
      self.autoGenerateDescription = !self.autoGenerateDescription;
    },
  }));

export type CardEditorStoreModelType = typeof CardEditorStore.Type;
